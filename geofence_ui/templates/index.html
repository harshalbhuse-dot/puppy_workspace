<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>üéØ Geofence Radius Predictor</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Walmart Colors */
        :root {
            --walmart-blue: #0053e2;
            --walmart-spark: #ffc220;
            --walmart-blue-dark: #004ac2;
        }
        
        .bg-walmart-blue { background-color: var(--walmart-blue); }
        .text-walmart-blue { color: var(--walmart-blue); }
        .bg-walmart-spark { background-color: var(--walmart-spark); }
        .text-walmart-spark { color: var(--walmart-spark); }
        .border-walmart-blue { border-color: var(--walmart-blue); }
        
        /* Focus ring */
        select:focus {
            outline: none;
            border-color: var(--walmart-blue);
            box-shadow: 0 0 0 3px rgba(0, 83, 226, 0.2);
        }
        
        /* Animation */
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.3s ease-out;
        }
        
        /* Pulse animation for loading */
        .htmx-request #result {
            opacity: 0.5;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-walmart-blue text-white py-6 shadow-lg">
        <div class="max-w-4xl mx-auto px-4">
            <div class="flex items-center gap-3">
                <span class="text-4xl">üéØ</span>
                <div>
                    <h1 class="text-2xl font-bold">Geofence Radius Predictor</h1>
                    <p class="text-blue-200 text-sm">Based on 26.8M delivery records</p>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">
        <!-- Input Card -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2">
                <span>üìù</span> Input Parameters
            </h2>
            
            <form hx-get="/predict" 
                  hx-target="#result" 
                  hx-trigger="change, load"
                  hx-swap="innerHTML"
                  class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <!-- Property Type -->
                <div>
                    <label for="property_type" class="block text-sm font-medium text-gray-600 mb-1">
                        Property Type
                    </label>
                    <select name="property_type" id="property_type" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 bg-white hover:border-gray-300 transition-colors cursor-pointer">
                        {% for pt in property_types %}
                        <option value="{{ pt }}" {% if pt == 'HOUSE' %}selected{% endif %}>
                            {{ property_labels[pt] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Address Source -->
                <div>
                    <label for="address_source" class="block text-sm font-medium text-gray-600 mb-1">
                        Address Source
                    </label>
                    <select name="address_source" id="address_source" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 bg-white hover:border-gray-300 transition-colors cursor-pointer">
                        {% for src in address_sources %}
                        <option value="{{ src }}" {% if src == 'AMS' %}selected{% endif %}>
                            {{ source_labels[src] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Density Category -->
                <div>
                    <label for="density_category" class="block text-sm font-medium text-gray-600 mb-1">
                        Population Density
                    </label>
                    <select name="density_category" id="density_category" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 bg-white hover:border-gray-300 transition-colors cursor-pointer">
                        {% for dc in density_categories %}
                        <option value="{{ dc }}" {% if dc == 'SUBURBAN' %}selected{% endif %}>
                            {{ density_labels[dc] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Percentile -->
                <div>
                    <label for="percentile" class="block text-sm font-medium text-gray-600 mb-1">
                        Percentile
                    </label>
                    <select name="percentile" id="percentile" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 bg-white hover:border-gray-300 transition-colors cursor-pointer">
                        {% for p in percentiles %}
                        <option value="{{ p }}" {% if p == 'P95' %}selected{% endif %}>
                            {{ percentile_labels[p] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Access Required -->
                <div class="md:col-span-2">
                    <label for="access_required" class="block text-sm font-medium text-gray-600 mb-1">
                        Access Required?
                    </label>
                    <select name="access_required" id="access_required" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 bg-white hover:border-gray-300 transition-colors cursor-pointer">
                        {% for acc in access_options %}
                        <option value="{{ acc }}" {% if acc == 'NO' %}selected{% endif %}>
                            {{ access_labels[acc] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </form>
        </div>

        <!-- Result Card -->
        <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-lg font-semibold text-gray-700 mb-6 flex items-center gap-2">
                <span>üìä</span> Recommended Geofence Radius
            </h2>
            
            <div id="result" class="min-h-[200px] flex items-center justify-center">
                <div class="text-center text-gray-400">
                    <div class="text-4xl mb-2">‚è≥</div>
                    <div>Loading...</div>
                </div>
            </div>
        </div>

        <!-- Info Card -->
        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-xl p-6">
            <h3 class="font-semibold text-walmart-blue mb-3 flex items-center gap-2">
                <span>üí°</span> How It Works
            </h3>
            <ul class="text-sm text-gray-600 space-y-2">
                <li><strong>Property Type:</strong> Different properties have different geocoding accuracy patterns.</li>
                <li><strong>Address Source:</strong> AMS is most accurate, Customer Pin is least accurate.</li>
                <li><strong>Density:</strong> Rural areas typically need slightly larger geofences.</li>
                <li><strong>Percentile:</strong> P95 captures 95% of deliveries - a good balance of accuracy and coverage.</li>
                <li><strong>Access Required:</strong> Gated communities, buzzers, and access codes increase radius by up to 28% (especially for apartments).</li>
            </ul>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center py-6 text-gray-400 text-sm">
        <p>Built with ‚ù§Ô∏è by Code Puppy üê∂ | Data: 26.8M delivery records</p>
    </footer>
</body>
</html>
